<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>General Pet Assistant - PawfectMatch</title>
  <style>
    /* Reset and base styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: linear-gradient(135deg, #fff5ea 0%, #f0e6d2 100%);
      color: #4B2E23;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    header {
      text-align: center;
      padding: 3rem 2rem;
      background: linear-gradient(135deg, #8B4A1E 0%, #6a3f1d 100%);
      color: #FFF5EA;
      box-shadow: 0 4px 20px rgba(139, 74, 30, 0.3);
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: repeating-linear-gradient(
        45deg,
        transparent,
        transparent 10px,
        rgba(255, 245, 234, 0.1) 10px,
        rgba(255, 245, 234, 0.1) 20px
      );
      animation: float 20s infinite linear;
    }

    @keyframes float {
      0% { transform: translateX(-50px) translateY(-50px); }
      100% { transform: translateX(50px) translateY(50px); }
    }

    header h1 {
      font-size: 2.8rem;
      margin-bottom: 0.5rem;
      font-weight: bold;
      position: relative;
      z-index: 1;
    }

    header p {
      font-size: 1.3rem;
      position: relative;
      z-index: 1;
      opacity: 0.9;
    }

    /* Navigation */
    .nav-section {
      text-align: center;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.1);
    }

    .nav-links {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .nav-link {
      text-decoration: none;
      color: #8B4A1E;
      background: rgba(255, 255, 255, 0.8);
      padding: 10px 20px;
      border-radius: 25px;
      transition: all 0.3s ease;
      font-weight: 600;
      box-shadow: 0 2px 10px rgba(139, 74, 30, 0.1);
    }

    .nav-link:hover {
      background: rgba(139, 74, 30, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(139, 74, 30, 0.2);
    }

    /* Main Content */
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }

    .chat-container {
      background: #FEE9D2;
      width: 100%;
      max-width: 700px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 600px;
      border: 2px solid #e0d5c7;
    }

    .chat-header {
      background: linear-gradient(135deg, #8B4A1E 0%, #6a3f1d 100%);
      color: white;
      padding: 1.5rem;
      text-align: center;
    }

    .chat-header h2 {
      margin-bottom: 0.5rem;
      font-size: 1.5rem;
    }

    .chat-header p {
      opacity: 0.9;
      font-size: 0.95rem;
    }

    #chatbox {
      flex: 1;
      padding: 1.5rem;
      overflow-y: auto;
      background: #fff5ea;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    /* Message Styles */
    .message {
      display: flex;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .message.user {
      justify-content: flex-end;
    }

    .message.bot {
      justify-content: flex-start;
    }

    .message-bubble {
      max-width: 75%;
      padding: 12px 16px;
      border-radius: 18px;
      word-wrap: break-word;
      line-height: 1.4;
    }

    .user .message-bubble {
      background: #8B4A1E;
      color: white;
      border-bottom-right-radius: 6px;
    }

    .bot .message-bubble {
      background: #e8f5e8;
      color: #4B2E23;
      border-bottom-left-radius: 6px;
      border-left: 4px solid #8B4A1E;
    }

    .message-sender {
      font-weight: bold;
      margin-bottom: 4px;
      font-size: 0.85rem;
    }

    .user .message-sender {
      color: #8B4A1E;
      text-align: right;
    }

    .bot .message-sender {
      color: #6a3f1d;
    }

    /* Input Area */
    .chat-input-area {
      display: flex;
      padding: 1.5rem;
      background: #fff;
      border-top: 1px solid #e0d5c7;
      gap: 0.5rem;
    }

    .chat-input-area input {
      flex: 1;
      padding: 12px 16px;
      font-size: 1rem;
      border: 2px solid #e0d5c7;
      border-radius: 25px;
      outline: none;
      transition: border-color 0.3s ease;
      background: #fff5ea;
    }

    .chat-input-area input:focus {
      border-color: #8B4A1E;
    }

    .chat-input-area button {
      padding: 12px 24px;
      font-size: 1rem;
      background: #8B4A1E;
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }

    .chat-input-area button:hover {
      background: #6a3f1d;
      transform: translateY(-1px);
    }

    .clear-btn {
      background: #d7d0c8 !important;
      color: #4B2E23 !important;
      margin-left: 0.5rem;
    }

    .clear-btn:hover {
      background: #bbb5ad !important;
    }

    /* Loading Animation */
    .typing-indicator {
      padding: 12px 16px;
      background: #f8f9fa;
      border-radius: 18px;
      border-bottom-left-radius: 6px;
      color: #8B4A1E;
      font-style: italic;
      max-width: 75%;
    }

    /* Scrollbar Styling */
    #chatbox::-webkit-scrollbar {
      width: 6px;
    }

    #chatbox::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }

    #chatbox::-webkit-scrollbar-thumb {
      background: #8B4A1E;
      border-radius: 3px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2rem;
      }
      
      header p {
        font-size: 1.1rem;
      }

      .chat-container {
        margin: 0 1rem;
        height: 500px;
      }

      .nav-links {
        flex-direction: column;
        align-items: center;
      }

      .message-bubble {
        max-width: 85%;
      }
    }

    @media (max-width: 480px) {
      main {
        padding: 1rem;
      }

      .chat-input-area {
        flex-direction: column;
      }

      .chat-input-area button {
        margin-top: 0.5rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üêæ PetMatch</h1>
    <p>Your Ultimate Pet Matching Assistant</p>
  </header>

  <nav class="nav-section">
    <div class="nav-links">
      <a href="index.html" class="nav-link">üè† Home</a>
      <a href="cat.html" class="nav-link">üê± Cats</a>
      <a href="dog.html" class="nav-link">üê∂ Dogs</a>
      <a href="rabbit.html" class="nav-link">ÔøΩ Rabbits</a>
      <a href="hamster.html" class="nav-link">üêπ Hamsters</a>
    </div>
  </nav>

  <main>
    <div class="chat-container">
      <div class="chat-header">
        <h2>üßô‚Äç‚ôÇÔ∏è Chat with PetMatch</h2>
        <p>Tell me about your lifestyle, preferences, and living situation to find your perfect pet companion!</p>
      </div>
      <div id="chatbox"></div>
      <div class="chat-input-area">
        <input type="text" id="userInput" placeholder="Tell me about your ideal pet..." />
        <button onclick="handleSend()">Send üöÄ</button>
        <button onclick="clearChat()" class="clear-btn">Clear</button>
      </div>
    </div>
  </main>

  <script>
    // API Configuration
    async function query(data) {
      const response = await fetch(
        "https://kawalski-flowise.hf.space/api/v1/prediction/718e560b-47d3-4845-9727-59a2fdc5cafc",
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        }
      );
      const result = await response.json();
      return result;
    }

    // Message rendering functions
    function renderMessage(sender, text, isBot = false) {
      const chatbox = document.getElementById("chatbox");
      const messageDiv = document.createElement("div");
      messageDiv.className = `message ${isBot ? 'bot' : 'user'}`;
      
      const bubble = document.createElement("div");
      bubble.className = "message-bubble";
      bubble.innerHTML = text;
      
      messageDiv.appendChild(bubble);
      chatbox.appendChild(messageDiv);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function showTypingIndicator() {
      const chatbox = document.getElementById("chatbox");
      const typingDiv = document.createElement("div");
      typingDiv.id = "typing-indicator";
      typingDiv.className = "message bot";
      typingDiv.innerHTML = '<div class="typing-indicator">üêæ PetMatch is thinking...</div>';
      chatbox.appendChild(typingDiv);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function removeTypingIndicator() {
      const typing = document.getElementById("typing-indicator");
      if (typing) typing.remove();
    }

    // Enhanced message handling
    async function handleSend() {
      const input = document.getElementById("userInput");
      const userMessage = input.value.trim();
      
      if (!userMessage) return;

      // Add user message
      renderMessage("user", userMessage, false);
      input.value = "";

      // Show typing indicator
      showTypingIndicator();

      try {
        // Enhanced prompt for better pet matching
        const enhancedPrompt = `You are PetMatch, a friendly and knowledgeable pet matching assistant. 
        The user is asking: "${userMessage}"
        
        Please provide helpful, personalized advice about pet selection, care, and compatibility. 
        Consider factors like living space, lifestyle, experience level, time availability, and preferences.
        Be warm, encouraging, and use emojis appropriately. Ask follow-up questions when helpful.
        Focus on finding the perfect pet match for their specific situation.`;

        const response = await query({ question: enhancedPrompt });
        
        removeTypingIndicator();
        
        // Process and display bot response
        let botMessage = response.text || "I'm sorry, I had trouble processing that. Could you try asking again?";
        
        // Basic markdown-like formatting
        botMessage = botMessage
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\*(.*?)\*/g, '<em>$1</em>')
          .replace(/`([^`]+)`/g, '<code style="background:#f0e6d2;padding:2px 4px;border-radius:3px;">$1</code>')
          .replace(/\n/g, '<br>');

        renderMessage("bot", botMessage, true);

      } catch (error) {
        removeTypingIndicator();
        renderMessage("bot", "üö´ Sorry, I'm having trouble connecting right now. Please try again in a moment!", true);
        console.error('Chat error:', error);
      }
    }

    // Clear chat functionality
    function clearChat() {
      if (confirm('Are you sure you want to clear the chat history?')) {
        const chatbox = document.getElementById("chatbox");
        chatbox.innerHTML = '';
        showWelcomeMessage();
      }
    }

    // Welcome message
    function showWelcomeMessage() {
      renderMessage("bot", `
        <strong>üßô‚Äç‚ôÇÔ∏è Welcome to PetMatch!</strong><br><br>
        I'm here to help you find the perfect pet companion! üêæ<br><br>
        Tell me about:
        <ul style="margin: 10px 0; padding-left: 20px;">
          <li>üè† Your living situation (apartment, house, yard size)</li>
          <li>‚è∞ How much time you can dedicate to pet care</li>
          <li>üí∞ Your budget for pet expenses</li>
          <li>üéØ What you're looking for in a pet (companionship, activity, etc.)</li>
          <li>üìö Your experience with pets</li>
        </ul>
        Let's find your perfect match! ‚ú®
      `, true);
    }

    // Enter key support
    document.addEventListener('DOMContentLoaded', function() {
      const input = document.getElementById('userInput');
      
      input.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          handleSend();
        }
      });

      // Show welcome message on load
      showWelcomeMessage();

      // Add hover effects to navigation
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(link => {
        link.addEventListener('mouseenter', function() {
          this.style.transform = 'translateY(-2px) scale(1.05)';
        });
        link.addEventListener('mouseleave', function() {
          this.style.transform = 'translateY(0) scale(1)';
        });
      });
    });
  </script>
</body>
</html>